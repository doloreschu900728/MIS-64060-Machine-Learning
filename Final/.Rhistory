Cluster_2 <- data[data$cluster == 2, ]
summary(Cluster_1)
summary(Cluster_2)
```
Analyze the clusters
```{r}
data$cluster <- k2$cluster
Cluster_1 <- data[data$cluster == 1, ]
Cluster_2 <- data[data$cluster == 2, ]
summary(Cluster_1)
summary(Cluster_2)
```
data
which.max(data[1, 23:30])
which.max(data[2, 23:30])
str(data)
which.max(data_norm[2, 23:30])
data_norm
data <- read.csv("BathSoap.csv")
str(data)
which.max(data[2, 23:30])
data <- read.csv("BathSoap.csv")
str(data)
data[,20] <- (as.numeric(gsub("%", "", (as.character(data[, 20])))))/100
data[,21] <- (as.numeric(gsub("%", "", (as.character(data[, 21])))))/100
data[,22] <- (as.numeric(gsub("%", "", (as.character(data[, 22])))))/100
data[,23] <- (as.numeric(gsub("%", "", (as.character(data[, 23])))))/100
data[,24] <- (as.numeric(gsub("%", "", (as.character(data[, 24])))))/100
data[,25] <- (as.numeric(gsub("%", "", (as.character(data[, 25])))))/100
data[,26] <- (as.numeric(gsub("%", "", (as.character(data[, 26])))))/100
data[,27] <- (as.numeric(gsub("%", "", (as.character(data[, 27])))))/100
data[,28] <- (as.numeric(gsub("%", "", (as.character(data[, 28])))))/100
data[,29] <- (as.numeric(gsub("%", "", (as.character(data[, 29])))))/100
data[,30] <- (as.numeric(gsub("%", "", (as.character(data[, 30])))))/100
data[,31] <- (as.numeric(gsub("%", "", (as.character(data[, 31])))))/100
data[,32] <- (as.numeric(gsub("%", "", (as.character(data[, 32])))))/100
data[,33] <- (as.numeric(gsub("%", "", (as.character(data[, 33])))))/100
data[,34] <- (as.numeric(gsub("%", "", (as.character(data[, 34])))))/100
data[,35] <- (as.numeric(gsub("%", "", (as.character(data[, 35])))))/100
data[,36] <- (as.numeric(gsub("%", "", (as.character(data[, 36])))))/100
data[,37] <- (as.numeric(gsub("%", "", (as.character(data[, 37])))))/100
data[,38] <- (as.numeric(gsub("%", "", (as.character(data[, 38])))))/100
data[,39] <- (as.numeric(gsub("%", "", (as.character(data[, 39])))))/100
data[,40] <- (as.numeric(gsub("%", "", (as.character(data[, 40])))))/100
data[,41] <- (as.numeric(gsub("%", "", (as.character(data[, 41])))))/100
data[,42] <- (as.numeric(gsub("%", "", (as.character(data[, 42])))))/100
data[,43] <- (as.numeric(gsub("%", "", (as.character(data[, 43])))))/100
data[,44] <- (as.numeric(gsub("%", "", (as.character(data[, 44])))))/100
data[,45] <- (as.numeric(gsub("%", "", (as.character(data[, 45])))))/100
data[,46] <- (as.numeric(gsub("%", "", (as.character(data[, 46])))))/100
str(data)
which.max(data[1,23:30])
which.max(data[2,23:30])
summary(data$Br..Cd..5)
head(data)
num <- as.numeric(which.max(data[2,23:30]))
num
data[2, 23:30]
max(data[2,23:30])
Max.Br.Cd <-max(data[,23:30])
Max.Br.Cd
which.max(data[,23:30])
which.max(data[1,23:30])
which.max(data[1:2,23:30])
?apply()
apply(data[1:2,23:30], max)
apply(data[1:2,23:30], 1, max)
Max.Br.Cd <- pply(data[,23:30], 1, max)
Max.Br.Cd <- apply(data[,23:30], 1, max)
Max.Br.Cd
data <- read.csv("BathSoap.csv")
head(data)
data[,20] <- (as.numeric(gsub("%", "", (as.character(data[, 20])))))/100
data[,21] <- (as.numeric(gsub("%", "", (as.character(data[, 21])))))/100
data[,22] <- (as.numeric(gsub("%", "", (as.character(data[, 22])))))/100
data[,23] <- (as.numeric(gsub("%", "", (as.character(data[, 23])))))/100
data[,24] <- (as.numeric(gsub("%", "", (as.character(data[, 24])))))/100
data[,25] <- (as.numeric(gsub("%", "", (as.character(data[, 25])))))/100
data[,26] <- (as.numeric(gsub("%", "", (as.character(data[, 26])))))/100
data[,27] <- (as.numeric(gsub("%", "", (as.character(data[, 27])))))/100
data[,28] <- (as.numeric(gsub("%", "", (as.character(data[, 28])))))/100
data[,29] <- (as.numeric(gsub("%", "", (as.character(data[, 29])))))/100
data[,30] <- (as.numeric(gsub("%", "", (as.character(data[, 30])))))/100
data[,31] <- (as.numeric(gsub("%", "", (as.character(data[, 31])))))/100
data[,32] <- (as.numeric(gsub("%", "", (as.character(data[, 32])))))/100
data[,33] <- (as.numeric(gsub("%", "", (as.character(data[, 33])))))/100
data[,34] <- (as.numeric(gsub("%", "", (as.character(data[, 34])))))/100
data[,35] <- (as.numeric(gsub("%", "", (as.character(data[, 35])))))/100
data[,36] <- (as.numeric(gsub("%", "", (as.character(data[, 36])))))/100
data[,37] <- (as.numeric(gsub("%", "", (as.character(data[, 37])))))/100
data[,38] <- (as.numeric(gsub("%", "", (as.character(data[, 38])))))/100
data[,39] <- (as.numeric(gsub("%", "", (as.character(data[, 39])))))/100
data[,40] <- (as.numeric(gsub("%", "", (as.character(data[, 40])))))/100
data[,41] <- (as.numeric(gsub("%", "", (as.character(data[, 41])))))/100
data[,42] <- (as.numeric(gsub("%", "", (as.character(data[, 42])))))/100
data[,43] <- (as.numeric(gsub("%", "", (as.character(data[, 43])))))/100
data[,44] <- (as.numeric(gsub("%", "", (as.character(data[, 44])))))/100
data[,45] <- (as.numeric(gsub("%", "", (as.character(data[, 45])))))/100
data[,46] <- (as.numeric(gsub("%", "", (as.character(data[, 46])))))/100
data <- Max.Br.Cd <- apply(data[,23:30], 1, max)
data_norm <- scale(data[,12:ncol(data)])
data$Max.Br.Cd <- apply(data[,23:30], 1, max)
data <- read.csv("BathSoap.csv")
str(data)
data[,20] <- (as.numeric(gsub("%", "", (as.character(data[, 20])))))/100
data[,21] <- (as.numeric(gsub("%", "", (as.character(data[, 21])))))/100
data[,22] <- (as.numeric(gsub("%", "", (as.character(data[, 22])))))/100
data[,23] <- (as.numeric(gsub("%", "", (as.character(data[, 23])))))/100
data[,24] <- (as.numeric(gsub("%", "", (as.character(data[, 24])))))/100
data[,25] <- (as.numeric(gsub("%", "", (as.character(data[, 25])))))/100
data[,26] <- (as.numeric(gsub("%", "", (as.character(data[, 26])))))/100
data[,27] <- (as.numeric(gsub("%", "", (as.character(data[, 27])))))/100
data[,28] <- (as.numeric(gsub("%", "", (as.character(data[, 28])))))/100
data[,29] <- (as.numeric(gsub("%", "", (as.character(data[, 29])))))/100
data[,30] <- (as.numeric(gsub("%", "", (as.character(data[, 30])))))/100
data[,31] <- (as.numeric(gsub("%", "", (as.character(data[, 31])))))/100
data[,32] <- (as.numeric(gsub("%", "", (as.character(data[, 32])))))/100
data[,33] <- (as.numeric(gsub("%", "", (as.character(data[, 33])))))/100
data[,34] <- (as.numeric(gsub("%", "", (as.character(data[, 34])))))/100
data[,35] <- (as.numeric(gsub("%", "", (as.character(data[, 35])))))/100
data[,36] <- (as.numeric(gsub("%", "", (as.character(data[, 36])))))/100
data[,37] <- (as.numeric(gsub("%", "", (as.character(data[, 37])))))/100
data[,38] <- (as.numeric(gsub("%", "", (as.character(data[, 38])))))/100
data[,39] <- (as.numeric(gsub("%", "", (as.character(data[, 39])))))/100
data[,40] <- (as.numeric(gsub("%", "", (as.character(data[, 40])))))/100
data[,41] <- (as.numeric(gsub("%", "", (as.character(data[, 41])))))/100
data[,42] <- (as.numeric(gsub("%", "", (as.character(data[, 42])))))/100
data[,43] <- (as.numeric(gsub("%", "", (as.character(data[, 43])))))/100
data[,44] <- (as.numeric(gsub("%", "", (as.character(data[, 44])))))/100
data[,45] <- (as.numeric(gsub("%", "", (as.character(data[, 45])))))/100
data[,46] <- (as.numeric(gsub("%", "", (as.character(data[, 46])))))/100
data$Max.Br.Cd <- apply(data[,23:30], 1, max)
data_norm <- scale(data[,12:ncol(data)])
str(data_norm)
data_norm
data_norm
str(data_norm)
colnames(data_norm)
data <- read.csv("BathSoap.csv")
str(data)
head(data)
colnames(data)
data[,20] <- (as.numeric(gsub("%", "", (as.character(data[, 20])))))/100
data[,21] <- (as.numeric(gsub("%", "", (as.character(data[, 21])))))/100
data[,22] <- (as.numeric(gsub("%", "", (as.character(data[, 22])))))/100
data[,23] <- (as.numeric(gsub("%", "", (as.character(data[, 23])))))/100
data[,24] <- (as.numeric(gsub("%", "", (as.character(data[, 24])))))/100
data[,25] <- (as.numeric(gsub("%", "", (as.character(data[, 25])))))/100
data[,26] <- (as.numeric(gsub("%", "", (as.character(data[, 26])))))/100
data[,27] <- (as.numeric(gsub("%", "", (as.character(data[, 27])))))/100
data[,28] <- (as.numeric(gsub("%", "", (as.character(data[, 28])))))/100
data[,29] <- (as.numeric(gsub("%", "", (as.character(data[, 29])))))/100
data[,30] <- (as.numeric(gsub("%", "", (as.character(data[, 30])))))/100
data[,31] <- (as.numeric(gsub("%", "", (as.character(data[, 31])))))/100
data[,32] <- (as.numeric(gsub("%", "", (as.character(data[, 32])))))/100
data[,33] <- (as.numeric(gsub("%", "", (as.character(data[, 33])))))/100
data[,34] <- (as.numeric(gsub("%", "", (as.character(data[, 34])))))/100
data[,35] <- (as.numeric(gsub("%", "", (as.character(data[, 35])))))/100
data[,36] <- (as.numeric(gsub("%", "", (as.character(data[, 36])))))/100
data[,37] <- (as.numeric(gsub("%", "", (as.character(data[, 37])))))/100
data[,38] <- (as.numeric(gsub("%", "", (as.character(data[, 38])))))/100
data[,39] <- (as.numeric(gsub("%", "", (as.character(data[, 39])))))/100
data[,40] <- (as.numeric(gsub("%", "", (as.character(data[, 40])))))/100
data[,41] <- (as.numeric(gsub("%", "", (as.character(data[, 41])))))/100
data[,42] <- (as.numeric(gsub("%", "", (as.character(data[, 42])))))/100
data[,43] <- (as.numeric(gsub("%", "", (as.character(data[, 43])))))/100
data[,44] <- (as.numeric(gsub("%", "", (as.character(data[, 44])))))/100
data[,45] <- (as.numeric(gsub("%", "", (as.character(data[, 45])))))/100
data[,46] <- (as.numeric(gsub("%", "", (as.character(data[, 46])))))/100
Max.Br.Cd <- apply(data[,23:30], 1, max)
Max.Br.Cd
data$Max.Br.Cd <- apply(data[,23:30], 1, max)
data
str(data)
colnames(data)
data$Max.Br.Cd <- apply(data[,23:31], 1, max)
colnames(data)
data <- data[,-23:31]
data <- data[,-c(23:31)]
data
colnames(data)
data <- read.csv("BathSoap.csv")
str(data)
head(data)
colnames(data)
data[,20] <- (as.numeric(gsub("%", "", (as.character(data[, 20])))))/100
data[,21] <- (as.numeric(gsub("%", "", (as.character(data[, 21])))))/100
data[,22] <- (as.numeric(gsub("%", "", (as.character(data[, 22])))))/100
data[,23] <- (as.numeric(gsub("%", "", (as.character(data[, 23])))))/100
data[,24] <- (as.numeric(gsub("%", "", (as.character(data[, 24])))))/100
data[,25] <- (as.numeric(gsub("%", "", (as.character(data[, 25])))))/100
data[,26] <- (as.numeric(gsub("%", "", (as.character(data[, 26])))))/100
data[,27] <- (as.numeric(gsub("%", "", (as.character(data[, 27])))))/100
data[,28] <- (as.numeric(gsub("%", "", (as.character(data[, 28])))))/100
data[,29] <- (as.numeric(gsub("%", "", (as.character(data[, 29])))))/100
data[,30] <- (as.numeric(gsub("%", "", (as.character(data[, 30])))))/100
data[,31] <- (as.numeric(gsub("%", "", (as.character(data[, 31])))))/100
data[,32] <- (as.numeric(gsub("%", "", (as.character(data[, 32])))))/100
data[,33] <- (as.numeric(gsub("%", "", (as.character(data[, 33])))))/100
data[,34] <- (as.numeric(gsub("%", "", (as.character(data[, 34])))))/100
data[,35] <- (as.numeric(gsub("%", "", (as.character(data[, 35])))))/100
data[,36] <- (as.numeric(gsub("%", "", (as.character(data[, 36])))))/100
data[,37] <- (as.numeric(gsub("%", "", (as.character(data[, 37])))))/100
data[,38] <- (as.numeric(gsub("%", "", (as.character(data[, 38])))))/100
data[,39] <- (as.numeric(gsub("%", "", (as.character(data[, 39])))))/100
data[,40] <- (as.numeric(gsub("%", "", (as.character(data[, 40])))))/100
data[,41] <- (as.numeric(gsub("%", "", (as.character(data[, 41])))))/100
data[,42] <- (as.numeric(gsub("%", "", (as.character(data[, 42])))))/100
data[,43] <- (as.numeric(gsub("%", "", (as.character(data[, 43])))))/100
data[,44] <- (as.numeric(gsub("%", "", (as.character(data[, 44])))))/100
data[,45] <- (as.numeric(gsub("%", "", (as.character(data[, 45])))))/100
data[,46] <- (as.numeric(gsub("%", "", (as.character(data[, 46])))))/100
data$Max.Br.Cd <- apply(data[,23:31], 1, max)
colnames(data)
data <- data[,-c(1:11,23:31)]
colnames(data)
data_norm <- scale(data[,1:ncol(data)])
library(factoextra)
distance <- get_dist(data_norm)
set.seed(123)
fviz_nbclust(data_norm, kmeans, method = "wss")
fviz_nbclust(data_norm, kmeans, method = "silhouette")
fviz_nbclust(data_norm, kmeans, method = "wss")
k2 <- kmeans(data_norm,centers = 2, nstart = 25)
k2$centers
k2$size
fviz_cluster(k2, data = data_norm)
data_norm
head(data_norm)
k2 <- kmeans(data_norm,centers = 2, nstart = 25)
k2$centers
k2$size
fviz_cluster(k2, data = data_norm)
data$cluster <- k2$cluster
Cluster_1 <- data[data$cluster == 1, ]
Cluster_2 <- data[data$cluster == 2, ]
summary(Cluster_1)
summary(Cluster_2)
library(caret)
Index_Train <- createDataPartition(data_norm, p=0.8, list = FALSE)
Validation <- data_norm[-Index_Train,]
set.seed(123)
model <- train(cluster~., data = data_norm, method = "knn")
model <- train(cluster~., data = data_norm, method = "knn")
model <- train(cluster~Max.Br.Cd , data = data_norm, method = "knn")
library(ISLR)
model <- train(cluster~Max.Br.Cd , data = data_norm, method = "knn")
model <- train(cluster~Max.Br.Cd , data = data_norm, method = "knn")
data_norm
class(data_norm)
?train()
model <- train(cluster~Max.Br.Cd+PropCat.15 , data = data_norm, method = "knn")
set.seed(123)
model <- train(cluster~Max.Br.Cd+PropCat.15, data = data_norm, method = "knn")
data_norm$cluster
data_norm$cluster <- k2$cluster
model <- train(cluster~Max.Br.Cd+PropCat.15, data = data_norm, method = "knn")
model <- train(cluster~., data = data_norm, method = "knn")
data_norm
str(data_norm)
data <- read.csv("BathSoap.csv")
str(data)
head(data)
colnames(data)
data[,20] <- (as.numeric(gsub("%", "", (as.character(data[, 20])))))/100
data[,21] <- (as.numeric(gsub("%", "", (as.character(data[, 21])))))/100
data[,22] <- (as.numeric(gsub("%", "", (as.character(data[, 22])))))/100
data[,23] <- (as.numeric(gsub("%", "", (as.character(data[, 23])))))/100
data[,24] <- (as.numeric(gsub("%", "", (as.character(data[, 24])))))/100
data[,25] <- (as.numeric(gsub("%", "", (as.character(data[, 25])))))/100
data[,26] <- (as.numeric(gsub("%", "", (as.character(data[, 26])))))/100
data[,27] <- (as.numeric(gsub("%", "", (as.character(data[, 27])))))/100
data[,28] <- (as.numeric(gsub("%", "", (as.character(data[, 28])))))/100
data[,29] <- (as.numeric(gsub("%", "", (as.character(data[, 29])))))/100
data[,30] <- (as.numeric(gsub("%", "", (as.character(data[, 30])))))/100
data[,31] <- (as.numeric(gsub("%", "", (as.character(data[, 31])))))/100
data[,32] <- (as.numeric(gsub("%", "", (as.character(data[, 32])))))/100
data[,33] <- (as.numeric(gsub("%", "", (as.character(data[, 33])))))/100
data[,34] <- (as.numeric(gsub("%", "", (as.character(data[, 34])))))/100
data[,35] <- (as.numeric(gsub("%", "", (as.character(data[, 35])))))/100
data[,36] <- (as.numeric(gsub("%", "", (as.character(data[, 36])))))/100
data[,37] <- (as.numeric(gsub("%", "", (as.character(data[, 37])))))/100
data[,38] <- (as.numeric(gsub("%", "", (as.character(data[, 38])))))/100
data[,39] <- (as.numeric(gsub("%", "", (as.character(data[, 39])))))/100
data[,40] <- (as.numeric(gsub("%", "", (as.character(data[, 40])))))/100
data[,41] <- (as.numeric(gsub("%", "", (as.character(data[, 41])))))/100
data[,42] <- (as.numeric(gsub("%", "", (as.character(data[, 42])))))/100
data[,43] <- (as.numeric(gsub("%", "", (as.character(data[, 43])))))/100
data[,44] <- (as.numeric(gsub("%", "", (as.character(data[, 44])))))/100
data[,45] <- (as.numeric(gsub("%", "", (as.character(data[, 45])))))/100
data[,46] <- (as.numeric(gsub("%", "", (as.character(data[, 46])))))/100
data$Max.Br.Cd <- apply(data[,23:31], 1, max)
data <- data[,-c(1:11,23:31)]
data_norm <- scale(data[,1:ncol(data)])
library(factoextra)
distance <- get_dist(data_norm)
set.seed(123)
fviz_nbclust(data_norm, kmeans, method = "wss")
fviz_nbclust(data_norm, kmeans, method = "silhouette")
k2 <- kmeans(data_norm,centers = 2, nstart = 25)
k2$centers
k2$size
fviz_cluster(k2, data = data_norm)
data$cluster <- k2$cluster
Cluster_1 <- data[data$cluster == 1, ]
Cluster_2 <- data[data$cluster == 2, ]
summary(Cluster_1)
summary(Cluster_2)
data <- read.csv("BathSoap.csv")
str(data)
head(data)
colnames(data)
data[,20] <- (as.numeric(gsub("%", "", (as.character(data[, 20])))))/100
data[,21] <- (as.numeric(gsub("%", "", (as.character(data[, 21])))))/100
data[,22] <- (as.numeric(gsub("%", "", (as.character(data[, 22])))))/100
data[,23] <- (as.numeric(gsub("%", "", (as.character(data[, 23])))))/100
data[,24] <- (as.numeric(gsub("%", "", (as.character(data[, 24])))))/100
data[,25] <- (as.numeric(gsub("%", "", (as.character(data[, 25])))))/100
data[,26] <- (as.numeric(gsub("%", "", (as.character(data[, 26])))))/100
data[,27] <- (as.numeric(gsub("%", "", (as.character(data[, 27])))))/100
data[,28] <- (as.numeric(gsub("%", "", (as.character(data[, 28])))))/100
data[,29] <- (as.numeric(gsub("%", "", (as.character(data[, 29])))))/100
data[,30] <- (as.numeric(gsub("%", "", (as.character(data[, 30])))))/100
data[,31] <- (as.numeric(gsub("%", "", (as.character(data[, 31])))))/100
data[,32] <- (as.numeric(gsub("%", "", (as.character(data[, 32])))))/100
data[,33] <- (as.numeric(gsub("%", "", (as.character(data[, 33])))))/100
data[,34] <- (as.numeric(gsub("%", "", (as.character(data[, 34])))))/100
data[,35] <- (as.numeric(gsub("%", "", (as.character(data[, 35])))))/100
data[,36] <- (as.numeric(gsub("%", "", (as.character(data[, 36])))))/100
data[,37] <- (as.numeric(gsub("%", "", (as.character(data[, 37])))))/100
data[,38] <- (as.numeric(gsub("%", "", (as.character(data[, 38])))))/100
data[,39] <- (as.numeric(gsub("%", "", (as.character(data[, 39])))))/100
data[,40] <- (as.numeric(gsub("%", "", (as.character(data[, 40])))))/100
data[,41] <- (as.numeric(gsub("%", "", (as.character(data[, 41])))))/100
data[,42] <- (as.numeric(gsub("%", "", (as.character(data[, 42])))))/100
data[,43] <- (as.numeric(gsub("%", "", (as.character(data[, 43])))))/100
data[,44] <- (as.numeric(gsub("%", "", (as.character(data[, 44])))))/100
data[,45] <- (as.numeric(gsub("%", "", (as.character(data[, 45])))))/100
data[,46] <- (as.numeric(gsub("%", "", (as.character(data[, 46])))))/100
data$Max.Br.Cd <- apply(data[,23:31], 1, max)
data <- data[,-c(1:11,23:31)]
data_norm <- scale(data[,1:ncol(data)])
library(factoextra)
distance <- get_dist(data_norm)
set.seed(123)
fviz_nbclust(data_norm, kmeans, method = "wss")
fviz_nbclust(data_norm, kmeans, method = "silhouette")
k2 <- kmeans(data_norm,centers = 2, nstart = 25)
k2$centers
k2$size
fviz_cluster(k2, data = data_norm)
data$cluster <- k2$cluster
Cluster_1 <- data[data$cluster == 1, ]
Cluster_2 <- data[data$cluster == 2, ]
summary(Cluster_1)
summary(Cluster_2)
data <- read.csv("BathSoap.csv")
str(data)
head(data)
colnames(data)
data[,20] <- (as.numeric(gsub("%", "", (as.character(data[, 20])))))/100
data[,21] <- (as.numeric(gsub("%", "", (as.character(data[, 21])))))/100
data[,22] <- (as.numeric(gsub("%", "", (as.character(data[, 22])))))/100
data[,23] <- (as.numeric(gsub("%", "", (as.character(data[, 23])))))/100
data[,24] <- (as.numeric(gsub("%", "", (as.character(data[, 24])))))/100
data[,25] <- (as.numeric(gsub("%", "", (as.character(data[, 25])))))/100
data[,26] <- (as.numeric(gsub("%", "", (as.character(data[, 26])))))/100
data[,27] <- (as.numeric(gsub("%", "", (as.character(data[, 27])))))/100
data[,28] <- (as.numeric(gsub("%", "", (as.character(data[, 28])))))/100
data[,29] <- (as.numeric(gsub("%", "", (as.character(data[, 29])))))/100
data[,30] <- (as.numeric(gsub("%", "", (as.character(data[, 30])))))/100
data[,31] <- (as.numeric(gsub("%", "", (as.character(data[, 31])))))/100
data[,32] <- (as.numeric(gsub("%", "", (as.character(data[, 32])))))/100
data[,33] <- (as.numeric(gsub("%", "", (as.character(data[, 33])))))/100
data[,34] <- (as.numeric(gsub("%", "", (as.character(data[, 34])))))/100
data[,35] <- (as.numeric(gsub("%", "", (as.character(data[, 35])))))/100
data[,36] <- (as.numeric(gsub("%", "", (as.character(data[, 36])))))/100
data[,37] <- (as.numeric(gsub("%", "", (as.character(data[, 37])))))/100
data[,38] <- (as.numeric(gsub("%", "", (as.character(data[, 38])))))/100
data[,39] <- (as.numeric(gsub("%", "", (as.character(data[, 39])))))/100
data[,40] <- (as.numeric(gsub("%", "", (as.character(data[, 40])))))/100
data[,41] <- (as.numeric(gsub("%", "", (as.character(data[, 41])))))/100
data[,42] <- (as.numeric(gsub("%", "", (as.character(data[, 42])))))/100
data[,43] <- (as.numeric(gsub("%", "", (as.character(data[, 43])))))/100
data[,44] <- (as.numeric(gsub("%", "", (as.character(data[, 44])))))/100
data[,45] <- (as.numeric(gsub("%", "", (as.character(data[, 45])))))/100
data[,46] <- (as.numeric(gsub("%", "", (as.character(data[, 46])))))/100
data$Max.Br.Cd <- apply(data[,23:31], 1, max)
data <- data[,-c(1:11,23:31)]
data_norm <- scale(data[,1:ncol(data)])
library(factoextra)
distance <- get_dist(data_norm)
set.seed(123)
fviz_nbclust(data_norm, kmeans, method = "wss")
fviz_nbclust(data_norm, kmeans, method = "silhouette")
k2 <- kmeans(data_norm,centers = 2, nstart = 25)
k2$centers
k2$size
fviz_cluster(k2, data = data_norm)
library(caret)
library(ISLR)
data_norm
str(data_norm)
data <- read.csv("BathSoap.csv")
data$Max.Br.Cd <- apply(data[,23:31], 1, max)
data <- data[,-c(1:11,23:31)]
data_norm <- scale(data[,1:ncol(data)])
data <- read.csv("BathSoap.csv")
data[,20] <- (as.numeric(gsub("%", "", (as.character(data[, 20])))))/100
data[,21] <- (as.numeric(gsub("%", "", (as.character(data[, 21])))))/100
data[,22] <- (as.numeric(gsub("%", "", (as.character(data[, 22])))))/100
data[,23] <- (as.numeric(gsub("%", "", (as.character(data[, 23])))))/100
data[,24] <- (as.numeric(gsub("%", "", (as.character(data[, 24])))))/100
data[,25] <- (as.numeric(gsub("%", "", (as.character(data[, 25])))))/100
data[,26] <- (as.numeric(gsub("%", "", (as.character(data[, 26])))))/100
data[,27] <- (as.numeric(gsub("%", "", (as.character(data[, 27])))))/100
data[,28] <- (as.numeric(gsub("%", "", (as.character(data[, 28])))))/100
data[,29] <- (as.numeric(gsub("%", "", (as.character(data[, 29])))))/100
data[,30] <- (as.numeric(gsub("%", "", (as.character(data[, 30])))))/100
data[,31] <- (as.numeric(gsub("%", "", (as.character(data[, 31])))))/100
data[,32] <- (as.numeric(gsub("%", "", (as.character(data[, 32])))))/100
data[,33] <- (as.numeric(gsub("%", "", (as.character(data[, 33])))))/100
data[,34] <- (as.numeric(gsub("%", "", (as.character(data[, 34])))))/100
data[,35] <- (as.numeric(gsub("%", "", (as.character(data[, 35])))))/100
data[,36] <- (as.numeric(gsub("%", "", (as.character(data[, 36])))))/100
data[,37] <- (as.numeric(gsub("%", "", (as.character(data[, 37])))))/100
data[,38] <- (as.numeric(gsub("%", "", (as.character(data[, 38])))))/100
data[,39] <- (as.numeric(gsub("%", "", (as.character(data[, 39])))))/100
data[,40] <- (as.numeric(gsub("%", "", (as.character(data[, 40])))))/100
data[,41] <- (as.numeric(gsub("%", "", (as.character(data[, 41])))))/100
data[,42] <- (as.numeric(gsub("%", "", (as.character(data[, 42])))))/100
data[,43] <- (as.numeric(gsub("%", "", (as.character(data[, 43])))))/100
data[,44] <- (as.numeric(gsub("%", "", (as.character(data[, 44])))))/100
data[,45] <- (as.numeric(gsub("%", "", (as.character(data[, 45])))))/100
data[,46] <- (as.numeric(gsub("%", "", (as.character(data[, 46])))))/100
data$Max.Br.Cd <- apply(data[,23:31], 1, max)
data <- data[,-c(1:11,23:31)]
data_norm <- scale(data[,1:ncol(data)])
str(data_norm)
data <- read.csv("BathSoap.csv")
data_norm <- scale(data[,1:ncol(data)])
data <- read.csv("BathSoap.csv")
data[,20] <- (as.numeric(gsub("%", "", (as.character(data[, 20])))))/100
data[,21] <- (as.numeric(gsub("%", "", (as.character(data[, 21])))))/100
data[,22] <- (as.numeric(gsub("%", "", (as.character(data[, 22])))))/100
data[,23] <- (as.numeric(gsub("%", "", (as.character(data[, 23])))))/100
data[,24] <- (as.numeric(gsub("%", "", (as.character(data[, 24])))))/100
data[,25] <- (as.numeric(gsub("%", "", (as.character(data[, 25])))))/100
data[,26] <- (as.numeric(gsub("%", "", (as.character(data[, 26])))))/100
data[,27] <- (as.numeric(gsub("%", "", (as.character(data[, 27])))))/100
data[,28] <- (as.numeric(gsub("%", "", (as.character(data[, 28])))))/100
data[,29] <- (as.numeric(gsub("%", "", (as.character(data[, 29])))))/100
data[,30] <- (as.numeric(gsub("%", "", (as.character(data[, 30])))))/100
data[,31] <- (as.numeric(gsub("%", "", (as.character(data[, 31])))))/100
data[,32] <- (as.numeric(gsub("%", "", (as.character(data[, 32])))))/100
data[,33] <- (as.numeric(gsub("%", "", (as.character(data[, 33])))))/100
data[,34] <- (as.numeric(gsub("%", "", (as.character(data[, 34])))))/100
data[,35] <- (as.numeric(gsub("%", "", (as.character(data[, 35])))))/100
data[,36] <- (as.numeric(gsub("%", "", (as.character(data[, 36])))))/100
data[,37] <- (as.numeric(gsub("%", "", (as.character(data[, 37])))))/100
data[,38] <- (as.numeric(gsub("%", "", (as.character(data[, 38])))))/100
data[,39] <- (as.numeric(gsub("%", "", (as.character(data[, 39])))))/100
data[,40] <- (as.numeric(gsub("%", "", (as.character(data[, 40])))))/100
data[,41] <- (as.numeric(gsub("%", "", (as.character(data[, 41])))))/100
data[,42] <- (as.numeric(gsub("%", "", (as.character(data[, 42])))))/100
data[,43] <- (as.numeric(gsub("%", "", (as.character(data[, 43])))))/100
data[,44] <- (as.numeric(gsub("%", "", (as.character(data[, 44])))))/100
data[,45] <- (as.numeric(gsub("%", "", (as.character(data[, 45])))))/100
data[,46] <- (as.numeric(gsub("%", "", (as.character(data[, 46])))))/100
a
data$Max.Br.Cd <- apply(data[,23:31], 1, max)
data <- data[,-c(1:11,23:31)]
str(data)
data_norm <- scale(data[,1:ncol(data)])
str(data_norm)
str(data)
data_norm <- scale(data[,c(1:ncol(data)])
data_norm <- scale(data[,c(1:ncol(data))])
str(data_norm)
str(data)
data_norm <- scale(data)
data_norm
str(data_norm)
?scale()
data_norm
library(caret)
data_norm <-preProcess(data,method = "range")
data_norm <- predict(norm_model,data)
norm_model<-preProcess(data,method = "range")
data_norm <- predict(norm_model,data)
str(data_norm)
set.seed(123)
data_norm$cluster <- k2$cluster
model <- train(cluster~., data = data_norm, method = "knn")
data_norm$cluster
str(data_norm)
data_norm$cluster <- as.factor(data_norm$cluster)
model <- train(cluster~., data = data_norm, method = "knn")
install.packages(e1071)
library(e1071)
install.packages("e1071")
data_norm$cluster <- k2$cluster
data_norm$cluster <- as.factor(data_norm$cluster)
model <- train(cluster~., data = data_norm, method = "knn")
model
search_grid <- expand.grid(k=c(1:5))
model <- train(cluster~., data = data_norm, method = "knn", tuneGrid=search_grid)
model
search_grid <- expand.grid(k=c(1:10))
model <- train(cluster~., data = data_norm, method = "knn", tuneGrid=search_grid)
model <- train(cluster~., data = data_norm, method = "knn", tuneGrid=search_grid)
model
